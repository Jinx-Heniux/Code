# vim

## 打开文件

```bash
vim /path/to/file
# 打开文件 光标在第1行

vim +10 /path/to/file
# 打开文件 光标在第10行

vim + /path/to/file
# 打开文件 光标在最后一行




# 使用vim编辑多个文件
vim FILE1 FILE2 FILE3

:next
# 切换至下一个文件

:prev
# 切换至前一个文件

:last
# 切换至最后一个文件

:first
# 切换至第一个文件

:qa
# 全部退出

:wa
# 保存所有文件

:wqa
#保存并退出所有文件





# 分窗口编辑多个文件

vim -o FILE1 FILE2...
# 水平分割显示

vim -O FILE1 FILE2...
# 垂直分割显示


```

## 分屏显示

```bash
Ctrl+w, s
# 水平拆分窗口，或末行模式下sp(split)

Ctrl+w, v
# 垂直拆分窗口，或末行模式下vs

# 在窗口间切换光标：
Ctrl+w, ARROW
```

## 输入模式

```bash
i
# 在当前光标所在字符的前面，转为输入模式，insert；
a
# 在当前光标所在字符的后面，转为输入模式，append；
o
# 在当前光标所在行的下方，新建一行，并转为输入模式；
I
# 在当前光标所在行的行首，转换为输入模式
A
# 在当前光标所在行的行尾，转换为输入模式
O
# 在当前光标所在行的上方，新建一行，并转为输入模式；

ESC
# 退出输入模式
```

## 末行模式

```bash
:
# 进入末行模式

:10d
# 删除第10行

:10,20d
# 删除第10到第20行

:set nu
# 显示行号

:! ls /etc
# 直接执行shell命令
# 再按一次回车键可以再次回到之前的界面。
```

## 关闭文件

```bash
########## 末行模式关闭文件
:q  
# 不保存退出
:wq 
# 保存并退出
:q! 
# 不保存并退出 强行退出
:w 
# 保存
:w! 
# 强行保存 只有管理员才可以这样做
:w cszhi.com   
# 保存至cszhi.com文件
:x
# 同:wq； 如果文件没有修改，直接退出；如果有修改，则保存后退出
:e!
# 放弃所有修改，并打开原来文件





########## 编辑模式下退出
ZZ
# 保存并退出
```

## 移动光标

```bash
##### 移动字符
h
# 向左移动一个字符
# 同删除键，Backspace
l
# 向右移动一个字符
# 同空格键，Space
j
# 向下移动一行
# 处于下一行的当前位置，如果为空白行，则行首
# 同回车键，Enter；区别：回车键用于移动到下一行非空白字符的行首，即第一个字符
k
# 向上移动一行
# 处于上一行的当前位置，如果为空白行，则行首
# 同减号键，-；区别：减号键用于移动到上一行非空白字符的行首，即第一个字符

# 可与数字连用
3h
# 向左三个字符
3j
# 向下移动三行




##### 移动单词
w
# 移动到下一个单词的词首； 会忽略句号（也就是.点）
3w
# 跳3个单词 
b
# 跳至当前或前一个单词的词首；会忽略句号（也就是.点）
# 移动到所在单词的词首，如果此时光标不在当前单词词首先跳到当 前单词的词首，
# 然后在按e就移动到下一个单词的词首



e
# 跳至当前或下一个单词的词尾
# 移动到所在单词的词尾，如果此时光标不在当前单词词尾先跳到当 前单词的词尾，
# 然后在按e就移动到下一个单词的词尾
ge 
# 移动到前一个单词的词尾，或跳到前一个标点符号





0
# 跳到绝对行首
^
# 跳到第一个非空白字符
$
# 绝对行尾




G
# 跳到文本的最后一行

gg
# 跳到文本的第一行

10G
10gg
# 跳到文本的第十行




# 末行模式下，直接给出行号即可
:2
# go to the second line
:100
# go to 100 line





##### 页面
H 
# 跳到屏幕的上部
M
# 跳到屏幕的中间
L
# 跳到屏幕的下面

zt
# 当前行移到顶
zz
# 当前行移到中
zb
# 当前行移到底




##### 句子跳转 以英文句号.为准
(
# 跳到上一句的句首
)
# 跳到下一句的句首




##### 段落跳转 以空白行为准
{
# 跳到上一段
}
# 跳到下一段
```



## 翻屏操作

```bash
Ctrl+f
# 向下翻一屏

Ctrl+b
# 向上翻一屏

Ctrl+d
# 向下翻半屏

Ctrl+u
# 向上翻半屏
```



## 删除操作

```bash
x
# 删除光标所在处的单个字符

数字x
# 删除光标所在处及向后的共几个字符

d$
# 删除从当前光标到行尾

d0
# 删除从当前光标到行首

d^
# 删除从当前光标到当前行的第一个非空白字符

dd
# 删除当前光标所在行

3dd
# 删除当前光标所在行，以及向下两行，共三行

:1,3d
# 末行模式下，删除从第一行到第三行

:1,.d
# 末行模式下，删除从第一行到当前光标所在行

:1,$d
# 末行模式下，删除从第一行到最后一行

:1,+5d
# 末行模式下，删除从当前行到再向下五行，共六行

:$-1,$d
# 末行模式下，删除从倒数第二行到最后一行，共两行

```



## 粘贴操作

```bash
p 
# 如果删除或复制为整行内容，则粘贴至光标所在行的下方，
# 如果复制或删除的内容为非整行，则粘贴至光标所在字符的后面；

P
# 大P
# 如果删除或复制为整行内容，则粘贴至光标所在行的上方，
# 如果复制或删除的内容为非整行，则粘贴至光标所在字符的前面；

```



## 复制操作

```bash
y
# 用法同d命令

```



## 修改操作

```bash
c
# 用法同d命令，先删除内容，再转换为输入模式

```



## 替换操作

```bash
r 
# 替换单个字符
R
# 进入替换模式

```



## 撤销操作

```bash
u
# undo 撤消前一次的编辑操作
# 连续u命令可撤消此前的n次编辑操作，vi只保存了此前的50次操作

Ctrl+r
# 撤消最近一次撤消操作

.
# 点：重复前一次编辑操作

```

## 可视化模式

```bash
v
# 按字符选取

V
# 大写P, 按行选取

ctrl+v
# 按矩形选取
```

## 查找操作（搜索）

```bash
/PATTERN
# 向下查找

?PATTERN
# 向上查找

n
# 下一个查找结果

N
# 上一个查找结果
```

## 查找并替换

```bash
# 在末行模式下使用s命令，格式同sed一样
# ADDR1,ADDR2s@PATTERN@string@gi
# 1,$：全文范围
# %：表示全文，等于 1,$
# g：全局替换
# i：忽略大小写

.,$-1s/pip/PIP/g
# 从当前行到倒数第二行，将pip换为PIP




# 练习：
# 将/etc/yum.repos.d/server.repo文件中的ftp://instructor.example.com/pub
# 替换为http://172.16.0.1/yum

%s/ftp:\/\/instructor\.example\.com\/pub/http:\/\/172.16.0.1\/yum/g

%s@ftp://instructor\.example\.com/pub@http://172.16.0.1/yum@g
```





